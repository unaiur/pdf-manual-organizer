# PDF Manual Index JSON Schema

## Overview
This schema defines the structure of the JSON index generated by the PDF indexing tool. The index is used by the web app to locate, filter, and display manuals.

## Top-Level Structure
```json
{
  "generatedAt": "2025-07-29T12:00:00Z",
  "pdfs": [
    { /* PDF entry */ },
    ...
  ]
}
```

- `generatedAt`: ISO8601 timestamp of index generation.
- `pdfs`: Array of PDF metadata entries.

## PDF Entry Structure
```json
{
  "path": "pdf/coffee/siemens-espresso-3000.pdf",
  "filename": "siemens-espresso-3000.pdf",
  "hash": "sha256:...",
  "tags": [
    "title=Siemens Espresso 3000 User Guide",
    "brand=Siemens", 
    "model=Espresso 3000",
    "device=coffee maker",
    "manualType=user guide",
    "location=kitchen"
  ],
  "pages": 48,
  "lastModified": "2025-07-28T18:00:00Z"
}
```

### Fields
- `path`: Relative path to the PDF (from web root).
- `filename`: PDF file name.
- `hash`: SHA256 hash of the file (for cache/integrity).
- `tags`: Array of all tags in `key=value` format. Includes both auto-discovered metadata and user-supplied tags.
- `pages`: Number of pages in the PDF.
- `lastModified`: Last modified timestamp (ISO8601).

## Tag System
- **Unified approach**: All metadata is stored as `key=value` tags in the `tags` array.
- **Auto-discovery**: Standard metadata (`title`, `brand`, `model`, `device`, `manualType`) is automatically extracted by LLM and added as tags.
- **User override**: User-supplied tags from `.tags` files take precedence over auto-discovered values.
- **Standard keys**: `title`, `brand`, `model`, `device`, `manualType` for core metadata.
- **Custom tags**: Users can add any additional tags (e.g., `location=kitchen`, `status=working`).

## Tag File Format (.tags)
Users can create a `.tags` file next to any PDF to add or override tags:
```
brand=Custom Brand
location=kitchen
priority=high
```

## Example
```json
{
  "generatedAt": "2025-07-29T12:00:00Z",
  "pdfs": [
    {
      "path": "pdf/coffee/siemens-espresso-3000.pdf",
      "filename": "siemens-espresso-3000.pdf",
      "hash": "sha256:abc123...",
      "tags": [
        "title=Siemens Espresso 3000 User Guide",
        "brand=Siemens",
        "model=Espresso 3000", 
        "device=coffee maker",
        "manualType=user guide",
        "location=kitchen"
      ],
      "pages": 48,
      "lastModified": "2025-07-28T18:00:00Z"
    }
  ]
}
```
